config:
  user.network-config: |
    version: 2
    ethernets:
      eth0:
        dhcp4: false
        dhcp6: false
        addresses: [ 192.168.1.30/24 ]
        gateway4: 192.168.1.1
        nameservers:
          addresses: [ 192.168.1.1 ]
          search: [ maas ]
  user.user-data: |
    #cloud-config
    package_upgrade: true
    packages:
      - jq
      - lnav
      - snapd
      - squashfuse
    write_files:
      - content: |
          clouds:
              maasctl:
                  type: maas
                  auth-types: [oauth1]
                  endpoint: http://192.168.1.10:5240/MAAS/api/2.0
        path: /root/maasctl.yaml
      - content: |
            credentials:
              maasctl:
                admin:
                  auth-type: oauth1
                  maas-oauth: maasctl_api_key
        path: /root/credentials-maasctl.yaml
    runcmd:
      - [snap, install, juju, --classic]
      - [sleep, 10]
      - [mkdir, /root/.juju]
      - [mv, /root/maasctl.yaml, /root/.juju/maasctl.yaml]
      - [mv, /root/credentials-maasctl.yaml, /root/.juju/credentials-maasctl.yaml]
description: ccio mini-stack maasctl container profile
devices:
  eth0:
    name: eth0
    nictype: macvlan
    parent: lan
    type: nic
  root:
    path: /
    pool: default
    type: disk
name: cloudctl
